/* SVN.committedRevision=373325 */
function loadBindOperate(){jQuery(".timeLeft").hover(function(){var e=jQuery(this).attr("tipId");jQuery("#"+e).show()},function(){var e=jQuery(this).attr("tipId");jQuery("#"+e).hide()});jQuery(".lookReason").click(function(){var g=jQuery(this).attr("goodreceiverid");var f="/order/displayUpdateAddress.do";var e="goodreceiverid="+g;jQuery.ajax({type:"post",url:f,data:e,success:function(h){YHD.alert(h)}})});jQuery(".orderListAgain").click(function(){var e=jQuery(this).attr("formAgainId");document.getElementById(e).submit();return false});jQuery(".confirmGood").click(function(){var f=jQuery(this).attr("oId");var g="您是不是已经收到您购买的商品？";var e='<div id="confirmDiv" class="aptab" style="left: 0px; top: 0px;"><div class="aptab_header"><ul><li class="fl pl10">温馨提示</li><li class="popwinClose fr btn_close mr10"><img src="'+imagePath+'/popwin/icon_close.jpg"></li><li class="popwinClose fr mr5 color_white"><a href="###">关闭</a></li></ul> <div class="clear"></div></div>';
e+='<div class="aptab_center" align="center"><p class="pt10">'+g+"</p>";e+='<div align="center"><input name="submit" class="pop_win_button popwinClose" id="pop_win_ok_btn" type="button"   value="确 定" /><input name="submit"   class="pop_win_button popwinClose" type="button" id="pop_win_cancel_btn" value="取消" /></div>';e+="</div>";e+='<div class="aptab_footer"><img src="'+imagePath+'/popwin/aptab_footer.jpg"></div></div>';YHD.popwin(e,300,50,null,null,null);jQuery("#pop_win_ok_btn").click(function(){window.location=URLPrefix.central+"/usermanager/order/updateOrderFinish.do?orderId="+f});jQuery("#pop_win_cancel_btn").click(function(){jQuery("#confirmDiv").hide()})});jQuery(".againBuy").click(function(){var e=jQuery(this).attr("productId");var f=jQuery(this).attr("merchantID");addToCart(this,e,f,1,true)
});jQuery(".commentProduct").click(function(){var f=jQuery(this).attr("productId");var h=jQuery(this).attr("merchantIDs");var e=jQuery(this).attr("soId");var g=jQuery(this).attr("image");var i=jQuery(this).attr("productname");appearAndShareExperience(f,h,e,g,i)});jQuery(".zhongXingOrder").click(function(){alert("中信验证专用订单")});jQuery(".openLock").click(function(){var g="/order/editOrder!unLockOrder.do";var e=jQuery(this).attr("oId");var f="orderId="+e;jQuery.ajax({type:"post",url:g,data:f,success:function(h){window.location="/order/myOrder.do"}})});function d(){var e=document.body.clientWidth;var f=document.body.clientHeight;jQuery("<div id='maskDiv'/>").width(e).height(f+document.body.scrollHeight/8).css("background","#000").css("position","absolute").css("top","0px").css("left","0px").css("opacity","0.1").css("filter","Alpha(Opacity=10)").css("z-index",1000).appendTo("body").fadeIn(200)
}var a="";var b="";var c="";jQuery(".cancelOrderItem").click(function(){d();YHD.popwinId("cancel_Order_reason");jQuery("#cancel_Order_reason").css("z-index",1200);jQuery("#myOrderCancelReasonOrderId").val(jQuery(this).attr("oId"));jQuery("#myOrderCancelReasonOrderCode").val(jQuery(this).attr("oCode"))});jQuery(".applyCancl").click(function(){d();YHD.popwinId("cancel_Order_reason_so2do");jQuery("#cancel_Order_reason_so2do").css("z-index",1200);jQuery("#myOrderCancelReasonOrderId_so2do").val(jQuery(this).attr("oId"));jQuery("#myOrderCancelReasonOrderCode_so2do").val(jQuery(this).attr("oCode"))});jQuery(".reasonpopwinClose").click(function(){jQuery("#cancel_Order_reason,#cancel_Order_reason_so2do").hide();jQuery("div[id=maskDiv]").remove()});jQuery(".netPayButton").click(function(){var e=jQuery(this).attr("oId");
window.open(URLPrefix.central+"/gateway/select_gateway.do?orderId="+e)});jQuery(".affirmPaymentButton").click(function(){var e=jQuery(this).attr("oId");var g=URLPrefix.my+"/order/displayAffirmPaymentCode.do";var f="orderId="+e+"&from=2";jQuery.ajax({type:"post",url:g,data:f,success:function(h){showAffirmPaymentCodePage(h)}})});jQuery(".evaluateOrderItem").click(function(){var e=jQuery(this).attr("oId");viewDeliveryEvaluationDiv(e)});jQuery(".closeDeliveryEvaluation").click(function(){jQuery("#deliveryEvaluationDiv").hide()});jQuery(".submitDeliveryEvaluation").click(function(){submitDeliveryEvaluation()});jQuery(".OrderStatusTrackMore").hover(function(){jQuery(this).siblings("div").children("div.package_track").show()},function(){jQuery(this).siblings("div").children("div.package_track").hide()
});ajaxGetUnCommentOrderInfo();ajaxGetOrderStatusTrackList()}function confirmItemOrder(){if(jQuery("#cancelReason").val()=="0"){alert("请选择一个取消订单的原因。");return false}var a=jQuery("#myOrderCancelReasonOrderId").val();var c="cancelReasonId="+jQuery("#cancelReason").val()+"&orderId="+a+"&orderCode="+jQuery("#myOrderCancelReasonOrderCode").val();jQuery.ajax({url:URLPrefix.my+"/order/cancelOrderReason.do",data:c,dataType:"jsonp",success:function b(d){window.location=URLPrefix.central+"/usermanager/order/cancelOrder.do?orderId="+a}});return false}function confirmItemOrder_so2do(){if(jQuery("#cancelReason_so2do").val()=="0"){alert("请选择一个取消订单的原因。");return false}var b=jQuery("#myOrderCancelReasonOrderId_so2do").val();var c=jQuery("#myOrderCancelReasonOrderCode_so2do").val();var a=jQuery("#cancelReason_so2do").val();
var d="cancelReasonId="+a+"&orderId="+b+"&orderCode="+c;jQuery.ajax({url:URLPrefix.my+"/order/cancelOrderReasonSo2Do.do",data:d,dataType:"jsonp",success:function(){window.location=URLPrefix.my+"/order/myOrder.do";jQuery(".reasonpopwinClose").click()},error:function(){jQuery(".reasonpopwinClose").click();alert("申请取消订单失败!")}});return false}function ajaxGetUnCommentOrderInfo(){var b=jQuery(".myOrderChooseRange").attr("isHistoryOrder");if(b==0){var a=URLPrefix.my+"/member/exp/getUserUnCommentOrderNumJson.do?callback=?";jQuery.getJSON(a,function(d){var c=d.awaitComment;if(c>0){jQuery("#orderCodeStr").val(d.orderIdStr);jQuery("#orderAwaitCommentNumTop").html("("+c+")");jQuery("#order_list_zhuanfen").removeClass("non");jQuery("#order_list_zhuanfen").attr("non",0);jQuery("#order_list_zhuanfen").addClass("order_list_zhuanfen")
}})}}function ajaxGetOrderStatusTrackList(){var c="";jQuery(".OrderStatusTrackOrderCode").each(function(d){if(d==0){c+="?orderCodes="+this.value}else{c+="&orderCodes="+this.value}});var a=new Array();jQuery("a[id^=cancelOrderLink_]").each(function(){c+="&applyCancelOrderIds="+jQuery(this).attr("oid");a.push(jQuery(this).attr("oid"))});if(c!=""){var b=URLPrefix.my+"/order/orderStatusTrackJsonpList.do"+c+"&callback=?";jQuery.getJSON(b,function(k){for(var h=0;h<k.orderStatusTrackJsonpList.length;h++){var e=k.orderStatusTrackJsonpList[h];jQuery("#OrderStatusTrackIsShowMore_"+e.orderCode).show();jQuery("#OrderStatusTrack_"+e.orderCode).html("("+e.trackFirstShow+")");jQuery("#OrderStatusTrackMore_"+e.orderCode).append(e.trackListStr)}for(var h=0;h<a.length;h++){var m=a[h];var d=false;if(k.cancelOrderLogJsonpList){for(var g=0;
g<k.cancelOrderLogJsonpList.length;g++){var l=k.cancelOrderLogJsonpList[g];if(!l){continue}if(m==l.orderId){if(l.cancelStatus==1){var f=l.interval<0?0:l.interval;f=f>48*3600?48*3600:f;jQuery("span[id=cancelOrderTip_"+l.orderId+"]").attr("interval",f);showCancelOrderTip(l.orderId)}d=true;break}}}if(!d){jQuery("a[id=cancelOrderLink_"+m+"]").show()}}setInterval("applyCancelOrderTimer()",1000)})}}function applyCancelOrderTimer(){jQuery("span[id^=cancelOrderTip_]:visible").each(function(){var a=$(this).attr("interval");if(a){var b=a-1;b=b<0?0:b;$(this).attr("interval",b)}})}function myOrderChooseType(e){var a=jQuery(e).attr("non");if(a!=1){var d=jQuery("#orderCodeStr").val();jQuery("#myOrderList").html(jQuery("#myoderLoadingDiv").html());var c=jQuery(".myOrderChooseRange").attr("isHistoryOrder");
if(c==0){var b=jQuery(e).attr("chooseType");jQuery.ajax({type:"post",url:"/order/orderMyList.do",data:"chooseType="+b+"&orderIdsStr="+d,success:function(f){jQuery("#myOrderList").html(f);loadBindOperate()}})}else{if(c==1){var b=jQuery(e).attr("chooseType");jQuery.ajax({type:"post",url:"/order/orderMyListHistory.do",data:"",success:function(f){jQuery("#myOrderList").html(f);loadBindOperate()}})}else{jQuery("#myOrderList").html("")}}}}function myOrderChooseRange(b){jQuery("#myOrderList").html(jQuery("#myoderLoadingDiv").html());var a=jQuery(b).attr("isHistoryOrder");if(a==0){jQuery.ajax({type:"post",url:"/order/orderMyList.do",data:"",success:function(c){jQuery("#userOrderHistoryPage").removeClass("on");jQuery("#userOrderHistoryPage").removeClass("myOrderChooseRange");jQuery("#userOrderPage").addClass("on");
jQuery("#userOrderPage").addClass("myOrderChooseRange");jQuery("#myOrderList").html(c);loadBindOperate()}})}else{if(a==1){jQuery.ajax({type:"post",url:"/order/orderMyListHistory.do",data:"",success:function(c){jQuery("#userOrderPage").removeClass("on");jQuery("#userOrderPage").removeClass("myOrderChooseRange");jQuery("#userOrderHistoryPage").addClass("on");jQuery("#userOrderHistoryPage").addClass("myOrderChooseRange");jQuery("#myOrderList").html(c);loadBindOperate()}})}else{jQuery("#myOrderList").html("")}}}jQuery(document).ready(function(){jQuery("#myOrderList").html(jQuery("#myoderLoadingDiv").html());var b=jQuery("#userOrderNum").val();var c=jQuery("#userOrderHistoryNum").val();var a=jQuery("#chooseType").val();if(b>0){jQuery("#userOrderPage").addClass("on");jQuery("#userOrderPage").addClass("myOrderChooseRange");
jQuery.ajax({type:"post",url:"/order/orderMyList.do",data:"chooseType="+a,success:function(d){jQuery("#myOrderList").html(d);loadBindOperate()}})}else{if(c>0){jQuery("#userOrderHistoryPage").addClass("on");jQuery("#userOrderHistoryPage").addClass("myOrderChooseRange");jQuery.ajax({type:"post",url:"/order/orderMyListHistory.do",data:"",success:function(d){jQuery("#myOrderList").html(d);loadBindOperate()}})}else{jQuery("#myOrderList").html("")}}loadUpbanner()});function showCancelOrderTip(a){jQuery("span[id=cancelOrderTip_"+a+"]").hover(function(){var c=$(this).attr("interval");var b=parseInt(c/3600)+"小时";var d=parseInt(c/60)%60+"分";var e=b+d;$(this).next().show().find("p").find("label").html(e)},function(){$(this).next().hide().find("p").find("label").empty()}).show()}function orderListPageInfo(a){var d=jQuery(".myOrderChooseRange").attr("isHistoryOrder");
var b=jQuery(".myOrderChooseType").attr("chooseType");var c=jQuery("#orderCodeStr").val();jQuery("#myOrderList").html(jQuery("#myoderLoadingDiv").html());if(d==0){jQuery.ajax({type:"post",url:"/order/orderMyList.do",data:"chooseType="+b+"&pageNum="+a+"&orderIdsStr="+c,success:function(e){jQuery("#myOrderList").html(e);loadBindOperate()}})}else{if(d==1){jQuery.ajax({type:"post",url:"/order/orderMyListHistory.do",data:"&pageNum="+a,success:function(e){jQuery("#myOrderList").html(e);loadBindOperate()}})}else{jQuery("#myOrderList").html("")}}window.scroll(0,0)}function closeDiv(){jQuery("#deployDiv").remove();jQuery("#maskdiv").remove()}var submitted=false;function setCardNum(a,b){$("cardNum_"+b).value=a;var c=document.getElementById("npfrm_"+b);c.action=URLPrefix.central+"/usermanager/order/netPay99BillPrePaidAction.do";
c.submit()}function showAffirmPaymentCodePage(a){YHD.alert(a,updatePayment)}function updatePayment(){var h=jQuery("#paymentType").val();var e="";var d=jQuery("#paymentName").val();var f=jQuery("#paymentDate").val();var a=jQuery("#paymentAmount").val();var c=jQuery("#orderId").val();var g="";if(d==""){g="汇款人不能为空";showAffirmPaymentCodePageNow(c,d,f,a,h,g);return}if(f==""){g="汇款日期不能为空";showAffirmPaymentCodePageNow(c,d,f,a,h,g);return}if(a==""){g="汇款金额不能为空";showAffirmPaymentCodePageNow(c,d,f,a,h,g);return}var i=/^-?\d+(\.\d+)?$/;if(!i.test(a)||a<=0){g="汇款金额填写有误";showAffirmPaymentCodePageNow(c,d,f,a,h,g);return}var b=URLPrefix.my+"/order/updatePaymentCodeFromMyIndex.do";var j="";if(h==3){var j="orderId="+c+"&paymentName="+d+"&paymentDate="+f+"&paymentCode="+e+"&paymentAmount="+a}else{var j="orderId="+c+"&paymentName="+d+"&paymentDate="+f+"&paymentAmount="+a
}jQuery.post(b,j,function(){orderListPageInfo(jQuery(".latestnewcurrentpage").html())})}function showAffirmPaymentCodePageNow(a,e,d,g,f,h){var b=URLPrefix.my+"/order/displayAffirmPaymentCode.do";var c="orderId="+a+"&from=2&paymentName="+e+"&paymentDate="+d+"&paymentAmount="+g+"&paymentType="+f+"&errorMsg="+h;jQuery.ajax({type:"post",url:b,data:c,success:function(i){showAffirmPaymentCodePage(i)}})}function loadUpbanner(){var a=URLPrefix.central+"/advertise/getMyOrderTopAdVo.do?callback=?";jQuery.getJSON(a,function(b){if(b.flag==1){jQuery("#myYihaodianUpbanner").html("<a id='imgLink' target='_blank' onclick=\"javascript:addTrackPositionToCookie('1','"+b.tk+"')\"><img src='"+b.imgPath+"' alt='"+b.content+"' width='980'></a>");jQuery("#imgLink").attr("href",b.link)}else{jQuery("#myYihaodianUpbanner").hide()
}})};var deliveryEvaluationOrderId;function viewDeliveryEvaluationDiv(b){if(deliveryEvaluationOrderId==b){deliveryEvaluationOrderId=b;jQuery("#deliveryEvaluationDiv").toggle()}else{deliveryEvaluationOrderId=b;jQuery("#deliveryEvaluationDiv").css("left",jQuery("#submitDeliveryEvaluation_"+b).offset().left-122+"px");jQuery("#deliveryEvaluationDiv").css("top",jQuery("#submitDeliveryEvaluation_"+b).offset().top+25+"px");jQuery("#deliveryEvaluationDiv").show()}}function closeDeliveryEvaluationDiv(){jQuery("#deliveryEvaluationDiv").hide()}function submitDeliveryEvaluation(){if(jQuery("input[name='deliveryEvaluation']:checked").size()==0){jQuery("#deliveryEvaluationWarning").removeClass();setTimeout("jQuery('#deliveryEvaluationWarning').addClass('none')",3000);return false}jQuery("#deliveryEvaluationDiv").hide();
var c=jQuery("input[name='deliveryEvaluation']:checked").val();var d="/usermanager/order/ajaxSubmitdeliveryEvaluation.do?datestamp="+new Date().getTime();jQuery.post(d,{userOrderId:deliveryEvaluationOrderId,deliveryEvaluation:c},afterSubmitDeliveryEvaluation,"json")}function afterSubmitDeliveryEvaluation(b){if(b.code==0){YHD.alert("订单评价失败！")}else{if(b.code==1){YHD.alert("评价成功，感谢您的支持！");jQuery("#submitDeliveryEvaluation_"+deliveryEvaluationOrderId).css("display","none");jQuery("#addFavoriteProducts_"+deliveryEvaluationOrderId).css("display","")}else{if(b.code==-1){YHD.alert("一个订单只可评价一次，您已经评价过这个订单了！");jQuery("#submitDeliveryEvaluation_"+deliveryEvaluationOrderId).css("display","none");jQuery("#addFavoriteProducts_"+deliveryEvaluationOrderId).css("display","")}}}};